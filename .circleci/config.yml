version: 2.1
orbs:
  terraform: circleci/terraform@3.2.1
workflows:
    example-workflow:
      jobs:
        - terraform/init:
            path: ./terraform
            context: terraform
        - terraform/plan:
            path: ./terraform 
            out: tfplan 
            context: terraform
        - terraform/apply:
            path: ./terraform
            plan: tfplan
            context: terraform
